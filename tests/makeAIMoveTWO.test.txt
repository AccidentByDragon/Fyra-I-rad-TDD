import { expect, test } from 'vitest';
import sleep from './helpers/mock-help/sleep.js';
import regPlayHumanVsAi from './helpers/common tasks/registerPlayersAIvsHuman.js';

// Test: Bot makes its move automatically without human move
test('Bot makes its move automatically without human move', async () => {
  const { body, app } = await regPlayHumanVsAi();

  console.log("Initial board state:");
  console.table(app.board.matrix.map(row => row.map(cell => cell.color || ' ')));

  await sleep(3000);  // Allow some time for the bot to move

  // Assuming the correct bot move function is found, such as `triggerBotMove()`
  if (!app.botMoveTriggered) {
    console.log("Bot move not triggered automatically, forcing the bot to move.");
    app.triggerBotMove();  // Replace with the correct function
  }

  const botMadeMove = [...body.querySelectorAll('.cell')]
    .some(cell => cell.getAttribute('class').includes('Yellow'));

  console.log("Checking if the bot made a move (Yellow)");
  console.table(app.board.matrix.map(row => row.map(cell => cell.color || ' ')));

  expect(botMadeMove).toBe(true);
  console.log("Bot has made a move successfully.");
}, 10000);
